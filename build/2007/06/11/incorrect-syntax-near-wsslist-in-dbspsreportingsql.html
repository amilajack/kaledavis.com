<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Incorrect syntax near 'WSSList' in dbSPSReporting.sql</title>
   <meta name="author" content="Kale Davis" />
   <link href="http://feeds.feedburner.com/kaledavis" rel="alternate" title="Kale Davis" type="application/atom+xml" />

   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
   <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
   <link href='http://fonts.googleapis.com/css?family=Droid+Serif' rel='stylesheet' type='text/css'>
   <link href='/images/favicon.ico' rel='shortcut icon' type='image/ico'>
 </head>
 <body>
   <div id="header"> 
     <div class="inner"> 
       <h1><a href="/">Hello, I'm Kale Davis</a></h1> 
       <h2>I <a href="http://www.simplerise.com">build</a> web apps and created the weekly <a href="http://www.hackernewsletter.com">Hacker Newsletter</a>. Find out more <a href="/about.html">about</a> me or say <a href="http://www.twitter.com/kale">hello</a>.
     </div> 
   </div> 

   <div id="content">
     <div class="inner">
       <h2>Incorrect syntax near 'WSSList' in dbSPSReporting.sql</h2>

<div id="post">
<p>Have you tried to use the <a href="http://www.microsoft.com/downloads/details.aspx?familyid=d81722ce-408c-4fb6-a429-2a7ecd62f674&amp;displaylang=en">SQL Server 2005 Report Pack for SPS</a>? I had used the previous version of this for SQL 2000 last year, but hadn't used it for a while. I remember having issues with the install of that previous version, and sure enough I had more issues this time as well.</p>

<p>Here is the error message you will see when you run the dbSPSReporting.sql script:</p>

<pre><code>Msg 102, Level 15, State 1, Procedure usp_Insert_FactWSS, Line 57 Incorrect syntax near 'WSSList'.
Cannot add rows to sys.sql_dependencies for the stored procedure because it depends on the missing
table 'usp_Insert_FactWSS'. The stored procedure will still be created; however, it cannot be
successfully executed until the table exists.
</code></pre>

<p>The problem is there is a missing comma after WSSDoc nvarchar(255):</p>

<div class="highlight"><pre><code class="sql"><span class="k">Create</span> <span class="k">table</span> <span class="n">dbo</span><span class="p">.</span><span class="n">tblTempWSS_ToFactLoad</span> <span class="p">(</span> <span class="n">WSSFactID</span> <span class="nb">bigint</span> <span class="k">identity</span> <span class="k">not</span> <span class="k">null</span> <span class="k">Primary</span> <span class="k">Key</span><span class="p">,</span> 
  <span class="n">SiteGUID</span> <span class="n">uniqueidentifier</span><span class="p">,</span> <span class="n">WebGUID</span> <span class="n">uniqueidentifier</span><span class="p">,</span> <span class="c1">-- WSSDate datetime, -- Fix for </span>
  <span class="n">Bug</span> <span class="o">#</span><span class="p">:</span> <span class="mi">403546</span> <span class="n">WSSDate</span> <span class="n">smalldatetime</span><span class="p">,</span> <span class="n">WSSTime</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="c1">--WSSUser nvarchar(150), --Fix </span>
  <span class="k">for</span> <span class="n">Bug</span> <span class="o">#</span><span class="p">:</span> <span class="mi">403546</span> <span class="n">WSSUser</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">255</span><span class="p">),</span> <span class="c1">--WSSDoc nvarchar(50), --Fix for Bug #: 403546 </span>
  <span class="n">WSSDoc</span> <span class="n">nvarchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="n">WSSList</span> <span class="n">uniqueidentifier</span>
</code></pre>
</div>


<p>Simply add the comma before you run the SQL script and everything will work fine. I find it very ironic that the new bug is right below the "Fix for Bug" comment that dealt with the previous problems in the first version. Bugs often introduce other bugs, but you would think something released for a Windows administrator would be checked a little closer.Â </p>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>17 Mar 2011</span> &raquo; <a href="/2011/03/17/hello-jekyll.html">Hello Jekyll</a></li>
    
      <li><span>21 Jul 2010</span> &raquo; <a href="/2010/07/21/exporting-data-from-mongohq.html">Exporting Data From MongoHQ</a></li>
    
      <li><span>23 Dec 2009</span> &raquo; <a href="/2009/12/23/killing-windows-services-that-hang-on-stopping.html">Killing Windows Services that hang on "STOPPING"</a></li>
    
  </ul>
</div>

     </div>
   </div>

   <div id="footer">
     <div class="inner">
       <a href="http://www.simplerise.com"><img src="/images/simplerise.png"/></a>
     </div>
   </div>

   <script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
   </script>
   <script type="text/javascript">
     _uacct = "UA-91485-5";
     urchinTracker();
   </script>
  </body>
</html>
